

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Time-evolution computations &mdash; Configuration Interaction  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Ground state calculations" href="ground_state.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Configuration Interaction
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="ground_state.html">Ground state calculations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Time-evolution computations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#time-dependent-configuration-interaction-super-class">Time-dependent configuration interaction super class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-truncated-tdci-classes">Creating truncated TDCI-classes</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Configuration Interaction</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Time-evolution computations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/time_evolution.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="time-evolution-computations">
<h1>Time-evolution computations<a class="headerlink" href="#time-evolution-computations" title="Permalink to this headline">¶</a></h1>
<p>The time-evolution of the configuration interaction method is done by computing
the ground state at a specified truncation level, and choosing initial
conditions for the coefficient vector <span class="math notranslate nohighlight">\(\mathbf{c}\)</span>.
The default choice is the ground state coefficient vector found from the ground
state computations, but other choices are valid as well as long as the
normalization of the coefficient vector is the same as for the eigenstates.</p>
<div class="section" id="time-dependent-configuration-interaction-super-class">
<h2>Time-dependent configuration interaction super class<a class="headerlink" href="#time-dependent-configuration-interaction-super-class" title="Permalink to this headline">¶</a></h2>
<p>Similarly to the ground state computations, the truncation level of the Slater
determinants decides which time-dependent configuration interaction class to
use.
However, this time the truncation level of the class decides which ground state
solver to use, whereas the time-dependent part only requires an initial state
represented as a coefficient vector <span class="math notranslate nohighlight">\(\mathbf{c}\)</span>.</p>
<dl class="py class">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction">
<em class="property">class </em><code class="sig-prename descclassname">configuration_interaction.tdci.</code><code class="sig-name descname">TimeDependentConfigurationInteraction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">system</span></em>, <em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class defining the skeleton of a time-dependent
configuration interaction solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>QuantumSystems</em>) – Quantum systems instance.</p></li>
<li><p><strong>s</strong> (<em>int</em>) – Spin projection number to keep. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code> and all
determinants are kept.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print timer and logging info. Default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">prev_c</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Function computing the right-hand side of the time-dependent
Schrödinger equation for the coefficient vector <span class="math notranslate nohighlight">\(\mathbf{c}(t)\)</span>.
That is, this function finds the time-derivative of the coefficient
vector from</p>
<div class="math notranslate nohighlight">
\[\dot{\mathbf{c}} = -i\mathbf{H}(t)\mathbf{c}(t).\]</div>
<p>This function is made to resemble the right-hand side functions
typically used for differential equation solvers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – Current timestep.</p></li>
<li><p><strong>prev_c</strong> (<em>np.ndarray</em>) – Coefficient vector at previous timestep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Time-derivative of coefficient vector at current timestep.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_energy">
<code class="sig-name descname">compute_energy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">c</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Function computing the energy of the time-evolved system with a
time-evolved Hamiltonian.</p>
<div class="math notranslate nohighlight">
\[E(t) = \frac{
    \langle\Psi(t)\rvert \hat{H}(t) \lvert\Psi(t)\rangle
}{
    \langle\Psi(t)\rvert\Psi(t)\rangle
}
= \frac{
    \mathbf{c}^{\dagger}(t) \mathbf{H}(t) \mathbf{c}(t)
}{
    \mathbf{c}^{\dagger}(t) \mathbf{c}(t)
},\]</div>
<p>where <span class="math notranslate nohighlight">\(\lvert\Psi(t)\rangle\)</span> is the time-evolved state given by</p>
<div class="math notranslate nohighlight">
\[\lvert\Psi(t)\rangle = c_I(t)\lvert\Phi_I\rangle,\]</div>
<p>with <span class="math notranslate nohighlight">\(\lvert\Phi_I\rangle\)</span> being Slater determinants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – Current timestep.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Coefficient vector at current timestep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The time-dependent energy <span class="math notranslate nohighlight">\(E(t)\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_density_matrix">
<code class="sig-name descname">compute_one_body_density_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_density_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute one-body density matrix for the time-dependent state
<span class="math notranslate nohighlight">\(\rvert\Psi(t)\rangle\)</span>,</p>
<div class="math notranslate nohighlight">
\[\rho^{q}_{p}(t)
= \langle\Psi(t)\rvert
\hat{c}^{\dagger}_{p}
\hat{c}_{q}
\lvert\Psi(t)\rangle.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – Current timestep.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Coefficient vector at current timestep.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance of trace warning. Default is <code class="docutils literal notranslate"><span class="pre">tol=1e-5</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The one-body density matrix <span class="math notranslate nohighlight">\(\rho^{q}_{p}(t)\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_expectation_value">
<code class="sig-name descname">compute_one_body_expectation_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">mat</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_expectation_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Function computing the expectation value of a one-body operator.
For a given one-body operator <span class="math notranslate nohighlight">\(\hat{A}\)</span> by</p>
<div class="math notranslate nohighlight">
\[\langle \hat{A} \rangle = \rho^{q}_{p} A^{p}_{q},\]</div>
<p>where <span class="math notranslate nohighlight">\(p, q\)</span> are general single-particle indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – The current time step.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – The coefficient vector at the current time step.</p></li>
<li><p><strong>mat</strong> (<em>np.ndarray</em>) – The one-body operator to evalute, as a matrix. The dimensionality
of the matrix must be the same as the one-body density matrix,
i.e., the number of basis functions <code class="docutils literal notranslate"><span class="pre">l</span></code>.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance for the one-body density matrix construction. Default
value is <code class="docutils literal notranslate"><span class="pre">1e-5</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The expectation value of the one-body operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>complex</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_density_matrix" title="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_one_body_density_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TimeDependentConfigurationInteraction.compute_one_body_density_matrix()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_overlap">
<code class="sig-name descname">compute_overlap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">c_0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Function computing the overlap between two states, viz.</p>
<div class="math notranslate nohighlight">
\[A(t, t_0) = \frac{
    \lvert \langle \Psi(t) \rvert \Psi(t_0) \rangle \rvert^2
}{
    \langle\Psi(t)\rvert\Psi(t)\rangle
    \langle\Psi(t_0)\rvert\Psi(t_0)\rangle
}
=  \frac{
    \lvert \mathbf{c}^{\dagger}(t) \mathbf{c}(t_0) \rvert^2
}{
    \lvert\mathbf{c}(t)\rvert^2
    \lvert\mathbf{c}(t_0)\rvert^2
},\]</div>
<p>where the <span class="math notranslate nohighlight">\(\mathbf{c}(t)\)</span> are the coefficient vectors of the
states <span class="math notranslate nohighlight">\(\lvert\Psi(t)\rangle\)</span> at specificed time-points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – Current timestep.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Coefficient vector at current timestep.</p></li>
<li><p><strong>c_0</strong> (<em>np.ndarray</em>) – The state to compare overlap with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The autocorrelation absolute squared.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_particle_density">
<code class="sig-name descname">compute_particle_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">current_time</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#configuration_interaction.tdci.TimeDependentConfigurationInteraction.compute_particle_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute particle density <span class="math notranslate nohighlight">\(\rho(x, t)\)</span> for the time-dependent
state <span class="math notranslate nohighlight">\(\rvert\Psi(t)\rangle\)</span>,</p>
<div class="math notranslate nohighlight">
\[\rho(x, t)
= \phi^{*}_q(x) \rho^{q}_{p}(t) \phi_p(x).\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_time</strong> (<em>float</em>) – Current timestep.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Coefficient vector at current timestep.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance parameter for the one-body density matrix. Default is
<code class="docutils literal notranslate"><span class="pre">tol=1e-5</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The particle density on the same grid as the single-particle
functions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="creating-truncated-tdci-classes">
<h2>Creating truncated TDCI-classes<a class="headerlink" href="#creating-truncated-tdci-classes" title="Permalink to this headline">¶</a></h2>
<p>This function is the time-dependent equivalent of the function defined for the
time-independent <a class="reference internal" href="ground_state.html#truncated-ci-classes"><span class="std std-ref">case</span></a></p>
<p>As an example of the setup of different classes we demonstrate the default
classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TDCIS</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CIS&quot;</span><span class="p">)</span>
<span class="n">TDCID</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CID&quot;</span><span class="p">)</span>
<span class="n">TDCISD</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CISD&quot;</span><span class="p">)</span>
<span class="n">TDCIDT</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CIDT&quot;</span><span class="p">)</span>
<span class="n">TDCISDT</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CISDT&quot;</span><span class="p">)</span>
<span class="n">TDCIDTQ</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CIDTQ&quot;</span><span class="p">)</span>
<span class="n">TDCISDTQ</span> <span class="o">=</span> <span class="n">get_tdci_class</span><span class="p">(</span><span class="s2">&quot;CISDTQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="ground_state.html" class="btn btn-neutral float-left" title="Ground state calculations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Øyvind Sigmundson Schøyen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>